<!DOCTYPE html>
<html style="margin: 0; padding: 0;">
<head>
    <title>ProCycle</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
</head>
<body style="background: linear-gradient(to right, lightgrey, white, lightgrey); font-family: Montserrat, sans-serif; font-weight: 700; margin: 0px; display: flex; flex-direction: column; min-height: 100vh; padding: 0;">
    <div style="height: 40px;">
        <img src="RainbowJersey.jpg" style="width: 100%;">
    </div>
<div style="flex-grow: 1">
    <h1 style="font-size: 60px; text-align: center; font-weight: 800; margin-top: 20px; margin-bottom: 20px;">PROCYCLE</h1>
    <h2 th:if="${mode == 'Daily'}" style="text-align: center; font-weight: 700;">Welcome to Daily PROCYCLE!</h2>
    <h2 th:if="${mode == 'Unlimited'}" style="text-align: center; font-weight: 700;">Welcome to Unlimited PROCYCLE!</h2>
    <div style="position: absolute; top: 10px; right: 10px;">
        <form action="/reveal" method="post" th:if="${won == null and guessHistory != null and revealed == null}" style="display: inline;">
            <button>Reveal Answer</button>
        </form>
        <form th:if="${mode == 'Daily'}" action="/Unlimited" method="post" style="display: inline;">
            <button>Play Unlimited</button>
        </form>
        <form th:if="${mode == 'Unlimited'}" action="/daily" method="post" style="display: inline;">
            <button>Play Daily</button>
        </form>
    </div>
    <form action="/guess" method="post" style="text-align: center;" th:if="${won == null and revealed == null}">
        <div style="position: relative; display: inline-block;">
            <input type="text" name="guess" id="guessInput" placeholder="Type a Professional Cyclist..." autocomplete="off"/>
            <div id="suggestions" style="position: absolute; background-color: white; width: 300px; left: 50%; transform: translateX(-50%); z-index: 10; max-height: 200px; overflow-y: auto;"></div>
        </div>
        <button>Guess</button>
    </form>
    
    <p th:if="${error}" th:text="${error}" style="color: red; text-align: center;"></p>

    <div th:if="${guessHistory}">
        <div th:if="${won}">
            <h3 style="font-size: 25px;text-align: center; margin-bottom: 10px; font-weight: 800;">YOU WON!</h3>
            <p th:if="${guessHistory != null}" th:text="'Guesses: ' + ${guessHistory.size()}" style="text-align: center; font-size: 20px; margin-top: 0px; font-weight: 750;"></p>
            <div style="text-align: center;">
                <form action="/Unlimited" method="post">
                    <button>Play Unlimited</button>
                </form>
            </div>
        </div>
        <div th:if="${revealed}" style="text-align: center;">
            <h3 th:text="'The answer was ' + ${revealedCyclist.name}"></h3>
        </div>
        
        <div th:each="guess : ${guessHistory}" style="display: flex; flex-wrap: wrap; justify-content: center; width: 600px; margin: auto; margin-top: 20px; margin-bottom: 20px;">
            <p th:text="${guess.guessedCyclist.name}" style="font-size: 35px; font-weight: 700; color: black; margin-bottom: 25px; width: 100%; text-align: center;">Name</p>
            <div th:style="'background-color: ' + ${guess.colors[0]} + '; width: 150px; padding: 10px; margin: 5px; text-align: center; color: white; border-radius: 10px;'"> 
                <p>Debut</p>
                <p>
                    <span th:text="${guess.guessedCyclist.debut}"></span>
                    <span th:text="${guess.arrows[0]}"></span>
                </p>
            </div>

            <div th:style="'background-color: ' + ${guess.colors[1]} + '; width: 150px; padding: 10px; margin: 5px; text-align: center; color: white; border-radius: 10px;'">
                <p>Team</p>
                <p th:text="${guess.guessedCyclist.team}"></p>
            </div>

            <div th:style="'background-color: ' + ${guess.colors[2]} + '; width: 150px; padding: 10px; margin: 5px; text-align: center; color: white; border-radius: 10px;'">
                <p>Professional Wins</p>
                <p>
                    <span th:text="${guess.guessedCyclist.wins}"></span>
                    <span th:text="${guess.arrows[1]}"></span>
                </p>
            </div>

            <div th:style="'background-color: ' + ${guess.colors[3]} + '; width: 150px; padding: 10px; margin: 5px; text-align: center; color: white; border-radius: 10px;'">
                <p>Gender</p>
                <p th:text="${guess.guessedCyclist.gender}"></p>
            </div>

            <div th:style="'background-color: ' + ${guess.colors[4]} + '; width: 150px; padding: 10px; margin: 5px; text-align: center; color: white; border-radius: 10px;'">
                <p>Specialty</p>
                <p th:text="${guess.guessedCyclist.specialty}"></p>
            </div>

            <div th:style="'background-color: ' + ${guess.colors[5]} + '; width: 150px; padding: 10px; margin: 5px; text-align: center; color: white; border-radius: 10px;'">
                <p>Nationality</p>
                <p th:text="${guess.guessedCyclist.nationality}"></p>
            </div>
        </div>
        <div th:if="${guessHistory != null and won == null and error == null}" style="display: flex; flex-wrap: wrap; justify-content: center; width: 600px; margin: auto; margin-top: 30px;">
                <div th:style="'background-color: black; width: 75px; padding: 10px; margin: 5px; text-align: center; color: white; border-radius: 10px;'">
                    <p>Incorrect</p>
                </div>
                <div th:style="'background-color: #F0C040; width: 75px; padding: 10px; margin: 5px; text-align: center; color: white; border-radius: 10px;'">
                    <p>Close</p>
                </div>
                <div th:style="'background-color: Green; width: 75px; padding: 10px; margin: 5px; text-align: center; color: white; border-radius: 10px;'">
                    <p>Correct</p>
        </div>
        </div>
    </div>
</div>
    <div style="background: linear-gradient(to bottom, #4A76C2 0% 20%, #AD2F40 20% 40%, black 40% 60%, #F0E24D 60% 80%, #66B148 80% 100%); height: 40px;"></div>
    
    <script th:inline="javascript">
    var cyclists = /*[[${listOfNames}]]*/ [];

    var input = document.getElementById("guessInput");
    var suggestions = document.getElementById("suggestions");

    if (input) {
        input.addEventListener("input", function() {
            var text = input.value.toLowerCase();
            suggestions.innerHTML = "";
                
            if (text.length == 0) {
                return;
            }
            
            for (var i = 0; i < cyclists.length; i++) {
            if (cyclists[i].toLowerCase().startsWith(text) || 
                cyclists[i].split(" ").some(function(part) { return part.toLowerCase().startsWith(text); })) {
                    var div = document.createElement("div");
                    div.textContent = cyclists[i];
                    div.style.cssText = "padding: 8px; cursor: pointer; border-bottom: 1px solid lightgray;";
                    div.addEventListener("click", function() {
                        input.value = this.textContent;
                        suggestions.innerHTML = "";
                        input.focus();
                    });
                    suggestions.appendChild(div);
                }
            }
        });
    }
</script>
 
</body>
<!export JAVA_HOME=/usr/local/sdkman/candidates/java/21.0.9-ms
export PATH=$JAVA_HOME/bin:$PATH
mvn spring-boot:run>